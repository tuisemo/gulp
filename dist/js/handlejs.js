define(["jquery","MSG"],function(){var e={userNameTrue:!1,telTrue:!1,emailTrue:!1,validateTrue:!1,pwdTrue:!1},t=function(){this.$userName=$("#userName"),this.$Tel=$("input[type='tel']"),this.$Email=$("input[type='email']"),this.$validateCode=$("#validateCode"),this.$codeimg=$("#codeimg"),this.$reloadBtn=$("#reloadBtn"),this.$Password=$(".password"),this.$SubmitBtn=$("#submit"),this.init()};t.prototype={init:function(){this.listen()},optMsg:function(e,t,a){t===!0?(e.parents(".form-group").addClass("has-success"),e.next(".help-block").html(MSG.true)):(e.parents(".form-group").addClass("has-error"),e.next(".help-block").html(MSG.false+MSG[a]))},checkuserName:function(){var t=this,a=t.$userName.val();/^[a-zA-Z][a-zA-Z0-9_]{2,19}$/.test(a)?$.ajax({url:"/checkTel",type:"GET",dataType:"json",data:{attributeName:"userName",attributeValue:a},success:function(a){a.result?(e.userNameTrue=!0,t.optMsg(t.$userName,!0)):t.optMsg(t.$userName,!1,202)}}):(e.userNameTrue=!1,t.optMsg(t.$userName,!1,"102"))},checkTel:function(){var t=this,a=t.$Tel.val();/^(((13[0-9]{1})|(15[0-9]{1})|(17[678]{1})|(18[0-9]{1}))+\d{8})$/.test(a)&&11==a.length?$.ajax({url:"/checkTel",type:"GET",dataType:"json",data:{attributeName:"mobile",attributeValue:a},success:function(a){a.result?(e.telTrue=!0,t.optMsg(t.$Tel,!0)):(telTrue=!1,t.optMsg(t.$Tel,!1,203))}}):(e.telTrue=!0,t.optMsg(t.$Tel,!1,202))},checkEmail:function(){var t=this,a=t.$Email.val();/^[a-z]([a-z0-9]*[-_]?[a-z0-9]+)*@([a-z0-9]*[-_]?[a-z0-9]+)+[\.][a-z]{2,3}([\.][a-z]{2})?$/i.test(a)?$.ajax({url:"/checkTel",type:"GET",dataType:"json",data:{attributeName:"email",attributeValue:a},success:function(a){a.result?(e.emailTrue=!0,t.optMsg(t.$Email,!0)):(emailTrue=!1,t.optMsg(t.$Email,!1,302))}}):(e.emailTrue=!1,t.optMsg(t.$Email,!1,302))},checkvalidateCode:function(){var t=this;$.ajax({url:"/checkTel",type:"GET",dataType:"json",data:{Code:t.$validateCode.val()},success:function(a){a.result?(e.validateTrue=!0,t.optMsg(t.$validateCode,!0)):(e.validateTrue=!1,t.optMsg(t.$validateCode,!1,302))}})},reloadvalidate:function(){var e=this;e.$validateCode.val(""),e.$codeimg.attr("src","http://www.ixm.gov.cn/dis/passport/authCode/show?"+Math.random()),validateTrue=!1},checkpassword:function(t){var a=this,s=a.$Password.val();/[A-Za-z].*[0-9]|[0-9].*[A-Za-z]/.test(s)?s.length<8||s.length>30?(e.pwdTrue=!1,a.optMsg(a.$Password,!1,502)):$.ajax({url:"/checkTel",type:"GET",dataType:"json",data:{userName:a.$userName.val()||"",password:s},success:function(t){t.result?(e.pwdTrue=!0,a.optMsg(a.$Password,!0)):(e.pwdTrue=!1,a.optMsg(a.$Password,!1,302))}}):(e.pwdTrue=!1,a.optMsg(a.$Password,!1,502))},confirmpwd:function(){alert("ok")},removeClass:function(e){e.parents(".form-group").removeClass("has-success has-warring has-error")},listen:function(){var e=this;e.$userName.on("blur",function(){e.checkuserName()}),e.$userName.on("focus",function(){e.removeClass($(this)),$(this).next(".help-block").html(MSG[101])}),e.$Tel.on("blur",function(){e.checkTel()}),e.$Tel.on("focus",function(){e.removeClass($(this)),$(this).next(".help-block").html(MSG[201])}),e.$validateCode.on("blur",function(){e.checkvalidateCode($(this))}),e.$validateCode.on("focus",function(){e.removeClass($(this)),$(this).next(".help-block").html(MSG[401])}),e.$codeimg.on("click",function(){e.reloadvalidate($(this))}),e.$reloadBtn.on("click",function(){e.reloadvalidate($(this))}),e.$Email.on("blur",function(){e.checkEmail()}),e.$Email.on("focus",function(){e.removeClass($(this)),$(this).next(".help-block").html(MSG[301])}),e.$Password.on("blur",function(){e.checkpassword()}),e.$Password.on("focus",function(){e.removeClass($(this)),$(this).next(".help-block").html(MSG[501])}),e.$SubmitBtn.on("click",function(){})}},window.checkFunc=new t});